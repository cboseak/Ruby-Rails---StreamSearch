function movieAutoComplete(e){var t=document.getElementById("movieInput").value,r="https://api.themoviedb.org/3/search/movie?api_key="+dbkey+"&query="+t,o=getRequest(r);availableTags=[];for(var a in o)if("results"==a)for(var s in o[a])for(var i in o[a][s])"title"==i&&(availableTags.push(),$("#movieInput").autocomplete({source:availableTags}))}function getMovieInfo(){resetAll();var e=gbbase+gbkey+"/movie/"+getGuideboxId(),t=getRequest(e);movieImageUrl=t.poster_120x171,movieName=t.title,movieDesc=t.overview,createInfoArea();for(var r in t)switch(r){case"free_android_sources":case"free_ios_sources":case"free_web_sources":for(var o in t[r])-1==$.inArray(t[r][o].source,freeSourceList)&&freeSourceList.push(t[r][o].source);case"purchase_android_sources":case"purchase_ios_sources":case"purchase_web_sources":for(var o in t[r])-1==$.inArray(t[r][o].source,paidSourceList)&&paidSourceList.push(t[r][o].source)}for(var a in freeSourceList)addToSourceList(freeSourceList[a],"Free");for(var a in paidSourceList)addToSourceList(paidSourceList[a],"Paid");var s=nfSearch(document.getElementById("movieInput").value);if(1==s.includes("yes")&&addToSourceList("netflix","Free"),freeTable.childElementCount>0){var i=document.createElement("p");i.innerHTML="<h3>Subscription Streaming Sources</h3>",document.getElementById("sources").appendChild(i),document.getElementById("sources").appendChild(freeTable)}if(paidTable.childElementCount>0){var i=document.createElement("p");i.innerHTML="<h3>Rental Streaming Sources</h3>",document.getElementById("sources").appendChild(i),document.getElementById("sources").appendChild(paidTable)}}function getGuideboxId(){var e=gbbase+gbkey+"/search/movie/id/themoviedb/"+getMovieId(),t=getRequest(e);return t.id}function getMovieId(){var e=document.getElementById("movieInput").value,t="https://api.themoviedb.org/3/search/movie?api_key="+dbkey+"&query="+e,r=getRequest(t);for(var o in r)if("results"==o)for(var e in r[o])for(var a in r[o][e])if("id"==a)return r[o][e][a]}function getSourceList(){var e=gbbase+gbkey+"/sources/subscription/all";getRequest(e)}function getMovieSources(){var e=gbbase+gbkey+"/movie/"+movieId;getRequest(e)}function createInfoArea(){var e=document.createElement("table"),t=e.insertRow(0),r=t.insertCell(0),o=t.insertCell(1);o.style.padding="10px",o.style.verticalAlign="top",r.innerHTML='<td><img src="'+movieImageUrl+'"></img></td>',o.innerHTML="<h3>"+movieName+"</h3><p>"+movieDesc+"</p>",document.getElementById("movieInfo").appendChild(e)}function addToSourceList(e,t){var r;switch(e){case"itunes":r=itunesLogo,e="Itunes";break;case"amazon_buy":r=amzLogo,e="Amazon";break;case"vudu":r=vuduLogo,e="VUDU";break;case"google_play":r=gpLogo,e="Google Play Store";break;case"cinemanow":r=cinemaNowLogo,e="CinemaNow";break;case"youtube_purchase":r=youtubeLogo,e="Youtube Purchase";break;case"sony":r=sonyLogo,e="Sony";break;case"flixster":r=flixsterLogo,e="Flixster";break;case"crackle":r=crackleLogo,e="Crackle";break;case"xbox":r=xboxLogo,e="XBOX Video";break;case"mgo":r=mgoLogo,e="M GO";break;case"netflix":r=netflixLogo,e="Netflix"}if("Free"==t){freeTable.classList.add("table");var o=freeTable.insertRow(0),a=o.insertCell(0),s=o.insertCell(1),i=o.insertCell(2);a.style.width="20%",s.style.width="50%",i.style.width="30%",a.innerHTML='<td><img  style="width:32px;height:32px;" src="'+r+'"></img></td>',s.innerHTML='<td class="sourceClass"><p><b>'+e+"</b></p></td>",i.innerHTML='<td class="sourceClass"><p><b>'+t+"</b></p></td>"}else if("Paid"==t){paidTable.classList.add("table");var o=paidTable.insertRow(0),a=o.insertCell(0),s=o.insertCell(1),i=o.insertCell(2);a.style.width="20%",s.style.width="50%",i.style.width="30%",a.innerHTML='<td class="sourceClass"><img  style="width:32px;height:32px;" src="'+r+'"></img></td>',s.innerHTML='<td class="sourceClass"><p><b>'+e+"</b></p></td>",i.innerHTML='<td class="sourceClass"><p><b>'+t+"</b></p></td>"}}function getRequest(e){event.preventDefault();var t=new XMLHttpRequest;t.open("GET",e,!1),t.send(null);var r=JSON.parse(t.responseText);return r}function getRawRequest(e){event.preventDefault();var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText}function nfSearch(e){var t="https://streamr-cboseak1.c9users.io/search/gl?title={"+e+"}";event.preventDefault();var r=new XMLHttpRequest;return r.open("GET",t,!1),r.send(null),r.responseText}function resetAll(){clearDomObject("sources"),clearDomObject("movieInfo"),freeSourceList=[],paidSourceList=[],freeTable.innerHTML="",paidTable.innerHTML=""}function clearDomObject(e){console.log("Clearing: "+e);var t=document.getElementById(e);t.innerHTML=""}var movieImageUrl="",movieName="",movieDesc="",availableTags=[],freeTable=document.createElement("table"),paidTable=document.createElement("table"),freeSourceList=[],paidSourceList=[],num=Math.round(1e5*Math.random()),callbackMethod="allflicks_"+num;window[callbackMethod]=function(e){};var movieId;document.addEventListener("DOMContentLoaded",function(e){document.getElementById("movieInput").addEventListener("input",movieAutoComplete)});